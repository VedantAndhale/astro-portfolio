---
import type { CollectionEntry } from "astro:content";
import PageLayout from "./PageLayout.astro";

type Props = {
    entry: CollectionEntry<"projects"> | CollectionEntry<"blog">;
};

const { entry } = Astro.props;
const { data } = entry;
const { title, summary, ogImage } = data;

// Get the base content directory path
const contentBase = `/src/content/${entry.collection}/${entry.slug}`;

// Resolve OG image path based on different path formats
const resolvedOgImage = ogImage
    ? ogImage.startsWith("./")
        ? `${contentBase}/${ogImage.slice(2)}`
        : ogImage.startsWith("/")
            ? ogImage
            : `${contentBase}/${ogImage}`
    : "/open-graph.png";

// Remove /src/ prefix if present (since it will be in the public path)
const publicOgImage = resolvedOgImage.startsWith("/src/") 
    ? resolvedOgImage.replace("/src/", "/") 
    : resolvedOgImage;
---

<PageLayout title={title} description={summary} image={publicOgImage}>
    <slot />
</PageLayout>
